## 技术内容

速致智能云平台属于公有云模式，采用云计算理念、模式和一系列先进开源技术整合基础的IT资源，并整合现有计算、存储、CDN 资源，逐步强化图片/视频处理能力，对外提供高效可靠的 IaaS 和 PaaS 云计算服务。

架构图

云计算系统拟包含以下单元，在云管理平台的统计管理调度下，各部件自动化、智能化地协同运行，实现最优的云计算基础设施架构：

1. 云管理平台：作为整体平台系统的大脑，利用 OpenStack 中的 Nova、Ceph、Neutron以及 Horizon 项目，并结合自有的二次开发整合专有的资源管理机制，将基础架构资源（包括计算、存储和网络）及其相关策略整合成虚拟数据中心资源池，通过构建基础架构资源池，搭建企业级应用开发平台，以及通过SOA架构整合服务来实现全服务周期的一站式服务，构建多层级、全方位的云资源管理体系。

2. 云计算基础：通过批量自主采购组装高性能的 x86 架构服务器，为业务应用提供强大、可扩展的计算能力。通过服务器虚拟化技术进行计算资源的整合与灵活利用，形成虚拟资源池，对上层应用提供自动化服务。

3. 云存储基础：提供海量可管理的共享存储，为集群应用和 HA 提供基础；为业务应用提供集中的数据存储池，采用先进的 IP 集群存储技术，保障存储容量和性能进行水平扩展，以便无缝地满足业务增长需求。整合高性能硬件设备，提供高 IO 批量处理能力，保证整体存储集群的处理性能。

4. 云网络基础：通过 SDN 技术，无需调整网络设备，通过速致云平台可将不同业务隔离在不同的私有网络中，保证各业务系统间的相互独立性，实现完整的数据中心网络功能。同时，提供网络拓扑功能让管理用户对虚拟网络结构一目了然。通过统一网络技术，将全国各 CDN 节点之间内网打通，依然通过中心平台进行网络功能相关处理。

5. 云安全基础：提供立体、深度的安全防护体系。使用的 VDC 私有网络，为二层隔离网络，不同的 VDC 之间完全做到广播域的隔离，保障嗅探、ARP 欺骗等问题的消除。结合安全组功能，安全组附着在每个虚拟网卡上，安全组可以通过，API、 Dashboard 配置，提供带状态的四层安全防护，能为云平台的资源提供针对性的按需安全策略。对于出公网的链路，公网核心路由之前部署了防火墙设备, 对公网进出流量进行应用级的保护和审查。

6. 自动图片优化：通过中心云平台集群的计算能力和存储支持，结合 CDN 分发平台自动帮用户对图片进行处理；支持批量云处理图片，包含自动处理特性，或者通过 API 让用户直接通过 HTTP 方式获取已处理资源。

图片 Webp 转换   自动处理    智能匹配合适设备，自动转换 webp 格式图片，总体能节省 30% ~ 60% 的图片大小，优化网络传输速度
JPEG 图片优化    自动处理    通过选择 JPEG 图片最优显示方案，自主优化图片，自动替换返回给用户
图片渐进式加载    API 调用   智能转换Progressive JPEG，多次扫描，渐进式加载，图片未加载完就显示轮廓。显示速度提升10倍，用户体验提升。
图片缩略         API 调用    通过定义参数提供一系列高级图片处理功能，包括缩放、裁剪、旋转等等
图片水印         API 调用    提供三种水印接口：图片水印、文字水印，以及一次请求中同时打多个水印
格式转换         API 调用    支持各类通用图片格式转换，包括有psd、jpeg、png、gif、webp、tiff、bmp等

7. 音视频处理服务：音视频处理是速致云处理平台提供的云处理功能，支持灵活上传以及快速转码，方便用户对音视频资源进行编码和格式转换。转码集群通过硬件转码加速技术可大幅减少转码的整体所需时间，整合云存储保证数据稳定存储，配合速致自建覆盖全国的分发网络节点保障不同地域及ISP接入用户的下载和上传速度，整体提供视频上传、转码、存储、审核和播放的全套能力。

8. 图片视频云识别：整合智能鉴黄的处理，基于深度学习以及有海量数据训练，提供高质量智能识别技术。速致技术团队使用各种方法优化程序，减少检测时间，已经基本可以达到实时检测的效果。基于人脸识别技术，研发的人脸检索技术可广泛应用在考勤、通关、门禁、签到、黑名单等场景，可针对不同人脸检索规模，为客户提供稳定、方便、快捷的人脸检索解决方案。


## 技术来源

速致智能云平台采用 OpenStack 开源平台和开发标准进行构建，支持原生 OpenStack API，充分利用成熟的 OpenStack 生态系统的所有资源进行优势整合。通过自主二次开发结合自有的硬件以及 CDN 分发处理架构，保证硬件以及运维成本的有效利用。OpenStack 是由全球顶尖开发者和 IT 巨头共同维护的云计算开源项目。

速致云存储使用基于 Ceph 的分布式存储系统提供块存储服务，在部署上，计算节点自带 SSD 形成高性能的存储池，构建存储计算超融合节点，使用单独的服务器挂载 SATA 磁盘，构建大容量的存储池。池的划分使用 Ceph 内建的 pool 的概念实现。

架构图如下:


速致云分发通过全国部署节点，使用 Nginx 做为反向代理服务器实现 CDN 网站/图片/视频点播/视频直播的加速效果。通过专有的冷热数据分离处理机制，保证了整体 CDN 系统的处理能力能达到业界最高水平，提供各类应用场景支持。


通过底层硬件 GPU 加速支持以及系统编解码技术的结合，速致的图片和视频的转码或自适应功能处理能达到很高的性能水准，比一般通过 CPU 运算进行的处理要快 30% ~ 500% 之间（不同的场景）。除了完美支持 Webp 图片标准处理，也能很好的支持 H.264、H.265、M-JPEG、MPEG 等普遍的视频编解码标准。

速致云平台的图片识别技术主要结合 OpenCV 开源框架技术，结合图像归一化算法、特征提取算法、GaussianFace 人脸识别算法以及机器学习算法等技术，基于深度学习网络，提取图片特征并聚类，达到相对最优的处理效果。


整体速致云平台通过智能化运维模式防范于未然，保证服务提供的可靠性和 SLA。使用七层负载均衡做健康检查策略,保障每个 HTTP 请求均由健康的 API 节点提供服务,七层负载均衡使用 VRRP 保持服务 IP 的故障自动化迁移,保障 API 的高可靠性。DB 的高可靠性使用 MySQL Replication 保障,通过 DNS 切换避免主库故障。消息的高可靠性使用了 RabbitMQ 内建的 Cluster 机制


速致智能云平台基于开源工具链研发的自动化部署流程体系，部署过程均为 ansible 控制各环节自动执行，保证能快速将服务器配置的相关事务自动化处理好。且能为服务器设定了完整的生命周期，包括服务器上架、初始化、配置部署、维护、下架，同时在 ansible 汇报时进行状态判断和状态更新，使得CMDB可以动态呈现每个服务器所处的状态，保证服务器状态一致。

主要部署流程图

硬件方面，根据各个应用场景不通进行独立最优采购。因为部署运维软件可以对整体服务器集群进行统一质量的监控管理，对于服务器的品牌没有进行特殊要求，确认硬件配置、芯片参数能够满足要求前提下，通过自主采购组装来进行服务器批量搭建，达到效能和成本的均衡。

对于交换机及一些配件，出于稳定性和兼容性的考虑。速致对市面上的主流硬件设备都进行了对比测试，来源于实际测试数据进行分析，来对设备进行采购，保证云平台的服务正常运转。




## 技术原则

1. 适用性：由于云计算平台往往会运行不只一个甚至不只一类应用，因此选择适用的设备是非常必要的。例如：开放架构的x86服务器适合互联网、或者增值应用，非x86架构的Unix服务器则更适合某些复杂应用、数据库应用，或对安全性和稳定性需要较高的场合;光纤SAN存储方式对于复杂的应用来说是一种很好的选择，IP存储则很适合某些相对比较独立，复杂程度不高的应用；传统交换机适合园区网应用，数据中心交换机则适合云计算环境应用。这一原则的贯彻，将帮助云计算平台实现计算能力和计算资源的优化。

2. 开放性：云计算平台区别于传统数据中心的一个重要特征，就是其对于应用的开放性，即云计算平台运行中，可能会陆续有不同类型的应用、服务被接入。尽管可以在接口类型等方面有具体的标准来规范，但是采用相对主流、开放、一体化的硬件架构、操作系统，对新增应用的无缝接入是必要的。

3. 兼容性：云计算平台硬件系统的兼容性表现在服务器接口、芯片种类、存储接口和架构等各个方面。例如，由于云计算通常会采用虚拟化技术来实现动态的管理，提高服务器和存储利用率，但是CPU对虚拟化技术的支持又是有差别的，这时，就需要选择对主流虚拟化软件兼容性较好的服务器和CPU来支持虚拟化的部署。同样，在网络设备中，如果要实现虚拟机跨网段的自由迁移，也需要交换机能够对这一功能具有很好的支持和兼容性。

4. 高密度：云计算平台的硬件选择，也需要考虑环境和空间的布置。传统的服务器需要占用大量的机架、空间，消耗大量的电缆和辅助材料。另外，空间的占用也会带来管理的困难，增加维护成本。为了营造一个高效的云计算平台，需要在硬件搭建时就考虑如何提高部署密度。

5. 绿色：对于云计算平台来说，实现绿色IT也是一个重要的、需要遵循的构建原则。规划较差的平台，会消耗更多的服务器、存储、网络设备，从而增加对这些设备提供冷却的精密空调数量，消耗大量的电能。这些消耗对于云计算平台来说，通过规划是完全可以避免的。另外，除了选择能耗较低的硬件产品，对冷却系统本身，在规划风道、出风方式、硬件格局等方面，也需要进行合理规划。

6. 服务。云计算系统涉及到机房基础设施、基础架构软硬件平台、虚拟化环境、业务应用与开发环境等一整套环境实施维护与业务流程，因此，需要有专业化、有很强服务能力的供应商、合作伙伴共同协作，保障系统实施、运维的效果。


## 实现思路

利用云的技术整合和发展我院现有IT系统，首先，要构建先进的系统架构；其次，要对现有IT资源进行盘点，能利旧整合的尽量整合，该及时淘汰的尽快淘汰；再次，按照新的架构，基于现有IT资源，新增部分IT资源，优化业务应用于部署，构建相对完善、可扩展的云计算中心。


## 建设目标（规划）

整体项目我们将分为 3 个阶段，整体规划完成时间需要 5 年，包括初中长期的规划。最终计划是中国建设成一个中心处理集群节点，香港建设成一个国际中转节点，围绕中心节点和中转节点部署达到 120 个国内外覆盖 CDN 节点。

基于成本和效果最优考虑，国内节点（中心和边缘节点）部署采用自行部署托管的方式来进行，国外节点（中转和边缘节点）部署采用租用托管方式来进行，预计总共需要 250 台采购服务器以及 150 台租用服务器。从而达到服务 5 万实际付费客户数量，每日数据处理量达到 12 亿次以上，CDN 节点日请求处理达到 200 亿次以上的云平台。

速致智能云平台从 2013 年中正式开始进行投入建设，现在正处于中期建设阶段，已覆盖节点数 45 个，共计投入采购服务器 100 台，租用服务器 52 台。整体的平台可以支撑每日 5 亿次的数据处理量，而 CDN 节点日请求处理能达到 80 亿次以上，现已覆盖 1 万的使用客户数。


### 初期建设目标

进行基础数据中心建设，逐步拓展 CDN 节点的部署。开始构建中心管理平台，使其具备对数据中心的基础资源（包括服务器、存储、网络等）的云管理能力，并加入资源占用、带宽租用、监管、迁移或退出服务等费用的计费方式和标准。开始搭建云计算平台，整合 OpenStack 等开源技术，需初步具有一定计算、存储资源能力可对外服务。

研究图片/视频处理相关技术，初步整合线上服务测试。

初期重点发展国内节点覆盖，并开始将中国的中心处理节点和香港的中转节点建设起来，需 40 台采购服务器以及 10 台租用服务器的硬件投入。达成能支撑日处理量千万级，CDN 请求处理量亿级的云平台。

### 中期建设目标

完成数据中心云平台的体系架构部分以及管理及运营要求的建设；完成资源池搭建，以及与相关接口的沟通，在 IAAS 层面构建较为完整的数据中心云计算平台，能够满足现有承载系统及新业务应用系统不断提高的资源服务需求。

开始整体细化速致智能云计算平台的可扩展性、可用性、可移植性、互操作性、功能、容量、性能等能否满足需求，并深入研究平台处理流程的安全能力（一般保护或增强保护），提高平台服务可用性到一个程度。

将图片/视频处理相关技术正式整合线上服务使用，通过实际用户使用反馈进一步调整相关功能，深化实际场景应用。

该阶段将开始加速国内外的节点覆盖，中国的中心处理节点的处理能力会重点建设起来，香港的中转节点也将搭配海外节点打通海外资源加速的应用，需进一步投入 90 台采购服务器以及 60 台租用服务器。预计整体的平能以支撑每日 8 亿次的数据处理量，而 CDN 节点日请求处理能达到 100 亿次以上，并覆盖 2 万以上的使用客户数。

### 长期建设目标

通过搭建完整的云计算数据中心平台（包括 IAAS 和 PAAS），具有统一建设的应用平台、统一的基础架构支撑平台、统一的安全管理体系，集中承载各种不同的应用系统，同时面向不同用户提供服务；实现统一管理、统一运维、统一支撑、统一标准，建立健全一套信息化协调发展的运行机制，创新息化建设应用模式和管理机制，推动信息化基础设施统建共用。

实际考虑整体服务的灾难恢复能力，包括研究高可用多机房互备热备方案，推进两地三中心互备方案等处理，从实质上提供服务的 SLA。

该阶段主要为扩大现有的数据处理能力和节点覆盖规模，从而提高用户质量体验，计划会投入 120 台采购服务器用于扩充中心处理节点规模以及 CDN 节点建设，以及 80 台租用服务器用来扩充海外 CDN 节点的覆盖。从而达到服务 5 万实际付费客户数量，每日数据处理量达到 12 亿次以上，CDN 节点日请求处理达到 200 亿次以上的云平台。


